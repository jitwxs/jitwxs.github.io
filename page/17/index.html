<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Jitwxs</title><meta name="author" content="Jitwxs"><meta name="copyright" content="Jitwxs"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="和我一起，走上资深BUG工程师之路">
<meta property="og:type" content="website">
<meta property="og:title" content="Jitwxs">
<meta property="og:url" content="https://jitwxs.cn/page/17/index.html">
<meta property="og:site_name" content="Jitwxs">
<meta property="og:description" content="和我一起，走上资深BUG工程师之路">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg">
<meta property="article:author" content="Jitwxs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/favicon.ico"><link rel="canonical" href="https://jitwxs.cn/page/17/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?053091e29f160d71ed2f65a774cfeac1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-40VH67TNSM"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-40VH67TNSM');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"POGNXMLA2T","apiKey":"2013ebed0f76818838d693c9c40cb1fd","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jitwxs","link":"链接: ","source":"来源: Jitwxs","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Jitwxs',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-02-19 15:24:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Jitwxs" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">231</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">134</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">44</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw far fa-newspaper"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/favorites/"><i class="fa-fw fas fa-meteor"></i><span> 收藏夹</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-cogs"></i><span> 管理</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-location-arrow"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/statistical/"><i class="fa-fw fas fa-globe-asia"></i><span> 站点统计</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jitwxs</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw far fa-newspaper"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/favorites/"><i class="fa-fw fas fa-meteor"></i><span> 收藏夹</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-cogs"></i><span> 管理</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-location-arrow"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/statistical/"><i class="fa-fw fas fa-globe-asia"></i><span> 站点统计</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/4be9221b.html" title="Navicat Premium 12.0.27 安装与激活">Navicat Premium 12.0.27 安装与激活</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-04T07:50:59.000Z" title="发表于 2018-05-04 15:50:59">2018-05-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Dev-Tools/">Dev Tools</a></span></div><div class="content">首先下载 Navicat Premium 12.0.27 安装包和破解工具：
Download For CSDN
Download For BaiduPan[14qh]
以下是重点，请务必仔细阅读！！
Step0：
运行安装包：navicat12027_premium_cs_x64.exe，常规安装即可。
Step1：
安装完成后，打开注册机：Navicat_Keygen_Patch_v3.4_By_DFoX_URET.exe：
1)Patch勾选Backup、Host和Navicat v12，然后点击Patch按钮：

找到Navicat Premium 12安装路径下的navicat.exe，选中并点击打开：

然后弹出Info对话框：

Step2：


License, Product and Language 确保 License 为Enterprise，Products 为Premium，Languages 为Simplified Chinese（简体中文，其它语言版本请自选）；


Resale License 确保 Resale Version 为Site licens ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/7ac4f061.html" title="Json Web Token 介绍与基本使用">Json Web Token 介绍与基本使用</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-02T18:25:18.000Z" title="发表于 2018-05-03 02:25:18">2018-05-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java-Web/">Java Web</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Java-Web/Spring-Framework/">Spring Framework</a></span></div><div class="content"> 一、Session 与 JWT
 1.1 传统 Cookie + Session
Cookie+Session 的存在主要是为了解决HTTP这一无状态协议下服务器如何识别用户的问题。
其原理就是在用户登录通过验证后，服务端将数据加密后存储在服务器 Session 中，同时服务器将 Session 的标识即 SessionId 存放在客户端 Cookie 中。
用户之后发起的请求都会携带 Cookie 信息，服务器根据 SessionId 寻回对应的 Session，从而完成验证，确认这是之前登陆过的用户。其工作原理如下图所示：

 1.2 JWT 技术
JWT，即 JSON Web Token，当用户使用它的认证信息登陆系统之后，会返回给用户一个 JWT，用户只需要本地保存即可。
当用户希望访问一个受保护的路由或者资源的时候，在请求头部添加该 JWT。后台获取请求头部的JWT并进行验证，如果合法，则允许用户的行为。

 二、JWT 的组成
一个 JWT 实际上就是一个字符串，它由三部分组成：头部、载荷(Payload)与签名。
 2.1 头部
头部用于描述关于该JWT的最基本的信息， ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/6da44730.html" title="Spring MVC 解决 HTTP 406 错误">Spring MVC 解决 HTTP 406 错误</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-16T16:45:50.000Z" title="发表于 2018-04-17 00:45:50">2018-04-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java-Web/">Java Web</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Java-Web/Spring-Framework/">Spring Framework</a></span></div><div class="content">在一般Java Web项目中，406错误，是比较少见的错误，导致原因一般是以下两种：
原因一： 缺少jackJson包
导入依赖即可：
12345&lt;dependency&gt;	&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;	&lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;	&lt;version&gt;2.9.4&lt;/version&gt;&lt;/dependency&gt;
原因二： 请求路径为*.html
当SpringMVC的拦截请求为*.html时，不允许返回json格式数据！
12345678910111213&lt;servlet&gt;    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;   ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/e843d977.html" title="Freemarker 初探">Freemarker 初探</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-16T03:07:35.000Z" title="发表于 2018-04-16 11:07:35">2018-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java-Web/">Java Web</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Java-Web/Template-Engine/">Template Engine</a></span></div><div class="content"> 一、什么是Freemarker
 1.1 介绍
FreeMarker 是一个用Java语言编写的模板引擎，它基于模板来生成文本输出。FreeMarker 与Web容器无关，即在 Web 运行时，它并不知道 Servlet 或 HTTP。它不仅可以用作表现层的实现技术，而且还可以用于生成 XML，JSP 或 Java 等。
主要用 Freemarker 做静态页面或是页面展示。

 1.2 入门程序
首先导入依赖：
12345&lt;dependency&gt;	&lt;groupId&gt;org.freemarker&lt;/groupId&gt;	&lt;artifactId&gt;freemarker&lt;/artifactId&gt;	&lt;version&gt;2.3.27-incubating&lt;/version&gt;&lt;/dependency&gt;
在我的D盘下，存在文件夹 flt ，用于存放模板文件；存在文件夹 flt_out，用于存放输出文件。
在 flt 文件夹下新建文件 test.ftl，内容为：
1$&#123;test&#125;

是不是有 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/7050d1f6.html" title="ActiveMQ 初探（1）——介绍与基本使用">ActiveMQ 初探（1）——介绍与基本使用</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-15T08:24:45.000Z" title="发表于 2018-04-15 16:24:45">2018-04-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Middleware/">Middleware</a></span></div><div class="content"> 一、ActiveMQ
 1.1 什么是 ActiveMQ
ActiveMQ 是Apache出品，最流行的，能力强劲的开源消息总线。ActiveMQ 是一个完全支持 JMS1.1 和 J2EE 1.4规 范的 JMS Provider 实现，尽管 JMS 规范出台已经是很久的事情了,但是 JMS 在当今的 J2EE 应用中间仍然扮演着特殊的地位。
主要特点：


多种语言和协议编写客户端。语言: Java, C, C++, C#, Ruby, Perl, Python, PHP。应用协议: OpenWire,Stomp REST,WS Notification,XMPP,AMQP


完全支持 JMS1.1 和 J2EE 1.4 规范 (持久化,XA消息,事务)


对 Spring 的支持，ActiveMQ 可以很容易内嵌到使用Spring的系统里面去,而且也支持 Spring2.0 的特性


通过了常见 J2EE 服务器(如 Geronimo,JBoss 4, GlassFish,WebLogic)的测试,其中通过 JCA 1.5 resource adaptors 的配置,可以 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/820a29b.html" title="Zookeper 集群搭建">Zookeper 集群搭建</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-12T09:08:26.000Z" title="发表于 2018-04-12 17:08:26">2018-04-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Middleware/">Middleware</a></span></div><div class="content">在《Dubbo + Zookeeper入门初探》这篇文章中，我们已经搭建了 Zookeeper 单机版，本篇文章将介绍如何搭建 Zookeeper 集群。
 一、投票选举机制
Zookeeper 集群在工作时，只有一个节点为 leader（主节点），其余节点均为 follower（从节点）。这是通过内部的投票选举机制来实现的。
我们知道，投票至少要过半数才行，因此集群中节点数最好为单数，因此我们搭建一个最简单的 3 个节点的 Zookeeper 集群。
 二、搭建集群
因为我没有弄三台Linux，所以本篇文章采用伪集群，均搭建在一台服务器上，采用端口号进行区分。首先列出相关信息，方便大家理解：
本机IP地址：192.168.30.155
Zookeeper01 ：/usr/local/zookeeper-cluster/zookeeper01



名称
端口号




客户端端口
2181


节点通信端口
2881


节点选举端口
3881



Zookeeper02：/usr/local/zookeeper-cluster/zookeeper02



名称
端口号




 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/96601bd.html" title="Solr 初探（6）——SolrCloud">Solr 初探（6）——SolrCloud</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-12T05:46:50.000Z" title="发表于 2018-04-12 13:46:50">2018-04-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Search-Engine/">Search Engine</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Search-Engine/Solr/">Solr</a></span></div><div class="content">Solr 集群，即 SolrCloud 是 Solr 提供的分布式搜索方案，当你需要大规模，容错，分布式索引和检索能力时使用 SolrCloud。SolrCloud 是基于 Solr 和 Zookeeper 的分布式搜索方案，它的主要思想是使用 Zookeeper 作为集群的配置信息中心。
当一个系统的索引数据量少的时候是不需要使用 SolrCloud 的，当索引量很大，搜索请求并发很高，这时需要使用 SolrCloud 来满足这些需求。它有几个特色功能：

集中式的配置信息
自动容错
近实时搜索
查询时自动负载均衡

 一、系统架构
（1）从物理结构来看，一个 SolrCloud 可以包含多个 Solr 实例，一个 Solr 实例可以有多个 Core，这些组成了一个 SolrCloud。
（2）从逻辑结构来看，SolrCloud 是一个逻辑意义上的完整的索引结构，称为 Collection，一个 Collection 使用一份配置文件。
Collection 常常被划分为一个或多个 Shard（分片）。每个Shard被化成一个或者多个 Replication，通过选举确定哪个是 Le ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/46ffa9b2.html" title="Solr 初探（5）——Solrj">Solr 初探（5）——Solrj</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-10T12:27:39.000Z" title="发表于 2018-04-10 20:27:39">2018-04-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Search-Engine/">Search Engine</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Search-Engine/Solr/">Solr</a></span></div><div class="content"> 一、导入依赖
导入Solr源码包dist文件夹下的solr-solrj-6.6.2.jar以及solrj-lib文件夹下的所有包到项目中。除此之外，还要加上log4j包和junit测试包。

 二、添加/更新数据
Solrj的使用十分简单，下面是一个添加数据的例子：
123456789101112131415@Testpublic void testAdd() throws Exception &#123;	// 指定url	String baseURL = &quot;http://localhost:8080/solr/core1&quot;;	// 1.创建Solr单机版客户端	HttpSolrClient solrClient = new HttpSolrClient(baseURL);	// 2.创建一个Document	SolrInputDocument doc = new SolrInputDocument();	doc.addField(&quot;id&quot;, &quot;10086&quot;);	doc.addField(&quot;author&quot ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/7aa79ad1.html" title="Solr 初探（4）——后台数据导入及 Document 的使用">Solr 初探（4）——后台数据导入及 Document 的使用</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-10T11:14:28.000Z" title="发表于 2018-04-10 19:14:28">2018-04-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Search-Engine/">Search Engine</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Search-Engine/Solr/">Solr</a></span></div><div class="content">进入Solr后台页面，选择一个核，点击 Documents，进入 Document 管理标签：

 一、添加 Document
在《Solr初探（2）——域管理》中我们已经说过了，id 是一个 Document 必须要包含的 field，让我们新建一个 Document，类型为 JSON：
1234&#123;&quot;id&quot; : 1,&quot;name&quot; : &quot;jitwxs&quot;&#125;
在查询页中点击 Execute Query 进行查询，就能看见我们添加的这个 Doucment 了：

 二、更新 Document
修改一个 Document 十分简单，只需要指定 id，Solr 就会先删除 id 为指定 id 的 Document，然后将我们输入的 Document 保存起来，达到更新的目的（内部实现是先删后添）。
当我们输入：
12345&#123;&quot;id&quot; : 1,&quot;author&quot;:&quot;jitwxs&quot;,&quot;content&quot; : &quot;哇哈哈哈&quo ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/b381cc92.html" title="Solr 初探（3）——配置 IK 分词器">Solr 初探（3）——配置 IK 分词器</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-04-10T08:03:17.000Z" title="发表于 2018-04-10 16:03:17">2018-04-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Search-Engine/">Search Engine</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Search-Engine/Solr/">Solr</a></span></div><div class="content">Solr 配置第三方分词器也是十分简单，这里以IK分词器为例。点击下载我自编译的 IK 分词器，支持到 JDK 1.8 + Lucene 6.6.2。
Step1： 将 IK 分词器的jar包放到 D:\apache-tomcat-8.5.16\webapps\solr\WEB-INF\lib 目录下。

Step2： 将 IK 分词器的配置文件放到 D:\apache-tomcat-8.5.16\webapps\solr\WEB-INF\classes 文件夹下，文件夹如果不存在手动创建：

这三个配置文件作用及内容不再赘述，查看文章：《Lucene初探——基于Lucene 6.6.2》
Step3： 在 managed-schema 配置文件中添加IK分词器的类型，以及创建使用 IK 分词器的域：
12345678&lt;!-- IK分词器 --&gt;&lt;fieldType name=&quot;text_ik&quot; class=&quot;solr.TextField&quot;&gt;	&lt;analyzer class=&quot;org.wltea.analy ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/16/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/#content-inner">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/#content-inner">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/#content-inner">24</a><a class="extend next" rel="next" href="/page/18/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jitwxs</div><div class="author-info__description">和我一起，走上资深BUG工程师之路</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">231</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">134</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">44</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jitwxs"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/jitwxs" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=Ujg7JiUqIRI0PSo-Mzs_fDE9Pw" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="https://jitwxs.blog.csdn.net" target="_blank" title="CSDN"><i class="fab fa-cuttlefish flat-btn"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>站点公告</span></div><div class="announcement_content"><span style="display:inline-block;text-indent:2em">专注Java技术栈，内容均为个人技术总结和思考，如有笔误，欢迎留言指正。</span><div style="width:100%;margin-top:10px;text-align:center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/wechat_qrcode.png"style="max-width:200px;margin:0 auto"class="entered loading"></div></div></div><div class="sticky_layout"><div class="card-widget card-weibo"><div class="card-content"><div class="item-headline"><i class="fab fa-weibo"></i><span>微博热搜</span></div><div id="weibo-container" style="width: 100%; height: 150px;font-size: 95%;"></div></div></div><script defer="defer" data-pjax="data-pjax" src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/js/card_weibo.js"></script><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/7cdf7e7b.html" title="Simple Binary Encoding">Simple Binary Encoding</a><time datetime="2021-12-25T06:17:00.000Z" title="发表于 2021-12-25 14:17:00">2021-12-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/8add723c.html" title="Agrona 高性高性能数据结构">Agrona 高性高性能数据结构</a><time datetime="2021-11-13T11:58:10.000Z" title="发表于 2021-11-13 19:58:10">2021-11-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/208fa04c.html" title="Mockito 源码分析（4）——Annotation">Mockito 源码分析（4）——Annotation</a><time datetime="2021-09-21T13:52:51.000Z" title="发表于 2021-09-21 21:52:51">2021-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/921b3e8a.html" title="Mockito 源码分析（3）——When 与 Then 与 Verify">Mockito 源码分析（3）——When 与 Then 与 Verify</a><time datetime="2021-09-20T12:32:05.000Z" title="发表于 2021-09-20 20:32:05">2021-09-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cb1af043.html" title="Mockito 源码分析（2）——Mock 与 Spy">Mockito 源码分析（2）——Mock 与 Spy</a><time datetime="2021-09-20T01:48:47.000Z" title="发表于 2021-09-20 09:48:47">2021-09-20</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Algorithm-Data-Structure/"><span class="card-category-list-name">Algorithm && Data Structure</span><span class="card-category-list-count">17</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Blockchain/"><span class="card-category-list-name">Blockchain</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Database/"><span class="card-category-list-name">Database</span><span class="card-category-list-count">18</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Database/Memory-Cache/"><span class="card-category-list-name">Memory Cache</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Database/MySQL/"><span class="card-category-list-name">MySQL</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Database/Redis/"><span class="card-category-list-name">Redis</span><span class="card-category-list-count">9</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Dev-Tools/"><span class="card-category-list-name">Dev Tools</span><span class="card-category-list-count">18</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Dev-Tools/Git/"><span class="card-category-list-name">Git</span><span class="card-category-list-count">8</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E9%9D%A2%E7%BB%8F/" style="font-size: 1.15em; color: rgb(40, 115, 115)">面经</a><a href="/tags/ActiveMQ/" style="font-size: 1.24em; color: rgb(65, 64, 170)">ActiveMQ</a><a href="/tags/Ajax/" style="font-size: 1.15em; color: rgb(159, 187, 30)">Ajax</a><a href="/tags/Javascript/" style="font-size: 1.19em; color: rgb(58, 149, 155)">Javascript</a><a href="/tags/Arthas/" style="font-size: 1.36em; color: rgb(20, 196, 172)">Arthas</a><a href="/tags/%E7%81%AB%E7%84%B0%E5%9B%BE/" style="font-size: 1.15em; color: rgb(118, 125, 2)">火焰图</a><a href="/tags/%E8%B7%A8%E5%9F%9F/" style="font-size: 1.15em; color: rgb(170, 168, 39)">跨域</a><a href="/tags/Vue/" style="font-size: 1.15em; color: rgb(4, 107, 114)">Vue</a><a href="/tags/Axiso/" style="font-size: 1.15em; color: rgb(90, 185, 100)">Axiso</a><a href="/tags/Disruptor/" style="font-size: 1.28em; color: rgb(142, 129, 115)">Disruptor</a><a href="/tags/Dubbo/" style="font-size: 1.15em; color: rgb(98, 21, 79)">Dubbo</a><a href="/tags/Zookeeper/" style="font-size: 1.19em; color: rgb(150, 109, 185)">Zookeeper</a><a href="/tags/Eclipse/" style="font-size: 1.15em; color: rgb(103, 85, 115)">Eclipse</a><a href="/tags/Elasticsearch/" style="font-size: 1.32em; color: rgb(89, 166, 1)">Elasticsearch</a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.15em; color: rgb(172, 46, 116)">索引</a><a href="/tags/Freemarker/" style="font-size: 1.15em; color: rgb(28, 171, 170)">Freemarker</a><a href="/tags/GCC/" style="font-size: 1.15em; color: rgb(106, 117, 58)">GCC</a><a href="/tags/Git/" style="font-size: 1.45em; color: rgb(19, 137, 30)">Git</a><a href="/tags/Jib/" style="font-size: 1.15em; color: rgb(68, 6, 100)">Jib</a><a href="/tags/SpringBoot/" style="font-size: 1.41em; color: rgb(20, 50, 106)">SpringBoot</a><a href="/tags/UML/" style="font-size: 1.15em; color: rgb(188, 63, 25)">UML</a><a href="/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" style="font-size: 1.15em; color: rgb(88, 88, 199)">动态代理</a><a href="/tags/AOP/" style="font-size: 1.19em; color: rgb(87, 161, 62)">AOP</a><a href="/tags/Fail-Fast/" style="font-size: 1.15em; color: rgb(128, 177, 93)">Fail Fast</a><a href="/tags/Fail-Safe/" style="font-size: 1.15em; color: rgb(136, 85, 56)">Fail Safe</a><a href="/tags/%E8%B8%A9%E5%9D%91%E4%B9%8B%E8%B7%AF/" style="font-size: 1.19em; color: rgb(198, 49, 159)">踩坑之路</a><a href="/tags/%E4%B8%89%E6%96%B9%E6%94%AF%E4%BB%98/" style="font-size: 1.15em; color: rgb(121, 11, 84)">三方支付</a><a href="/tags/%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE/" style="font-size: 1.15em; color: rgb(124, 77, 160)">双亲委派</a><a href="/tags/%E9%98%9F%E5%88%97/" style="font-size: 1.24em; color: rgb(183, 18, 156)">队列</a><a href="/tags/ArrayBlockingQueue/" style="font-size: 1.15em; color: rgb(189, 17, 172)">ArrayBlockingQueue</a><a href="/tags/CyclicBarrier/" style="font-size: 1.15em; color: rgb(49, 164, 44)">CyclicBarrier</a><a href="/tags/Thread/" style="font-size: 1.15em; color: rgb(39, 114, 78)">Thread</a><a href="/tags/XML/" style="font-size: 1.15em; color: rgb(72, 158, 130)">XML</a><a href="/tags/Optional/" style="font-size: 1.15em; color: rgb(40, 101, 98)">Optional</a><a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 1.15em; color: rgb(166, 177, 14)">文件系统</a><a href="/tags/Linux/" style="font-size: 1.15em; color: rgb(171, 77, 92)">Linux</a><a href="/tags/Database/" style="font-size: 1.15em; color: rgb(47, 99, 91)">Database</a><a href="/tags/Tomcat/" style="font-size: 1.15em; color: rgb(199, 133, 182)">Tomcat</a><a href="/tags/%E9%9D%99%E6%80%81%E5%BA%93/" style="font-size: 1.15em; color: rgb(126, 174, 124)">静态库</a><a href="/tags/%E5%8A%A8%E6%80%81%E5%BA%93/" style="font-size: 1.15em; color: rgb(170, 130, 28)">动态库</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">231</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2016-11-12T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">573k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-02-19T07:24:42.694Z"></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(135deg,"><div id="footer-wrap"><div class="copyright">&copy;2016 - 2022 By Jitwxs</div><div class="footer_custom_text"><p><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action"><img class="icp-icon entered loading"src="/img/icp.png"alt="ICP"data-ll-status="loading">苏ICP备16061429号</a></p><p><a style="margin-inline:5px"target="_blank"href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo"title="博客框架为 Hexo"alt="HEXO"></a><a style="margin-inline:5px"target="_blank"href="https://github.com/jerryc127/hexo-theme-butterfly"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender"title="主题采用 Butterfly"alt="Butterfly"></a><a style="margin-inline:5px"target="_blank"href="https://www.jsdelivr.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr"title="本站使用 Jsdelivr 为静态资源提供CDN加速"alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank"href="https://github.com/jitwxs/blog-butterfly"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub"title="本站项目由 GitHub 托管"alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris"alt="img"title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/jitwxs/blog-comment/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["link[rel=\"canonical\"]","meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-40VH67TNSM', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?jitwxs";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="jitwxs";
            var parent_div_git = document.getElementById('about-github-calendar');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('about-github-calendar')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>