<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jitwxs</title><meta name="author" content="Jitwxs"><meta name="copyright" content="Jitwxs"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="不忘初心，砥砺前行">
<meta property="og:type" content="website">
<meta property="og:title" content="Jitwxs">
<meta property="og:url" content="https://jitwxs.cn/page/16/index.html">
<meta property="og:site_name" content="Jitwxs">
<meta property="og:description" content="不忘初心，砥砺前行">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg">
<meta property="article:author" content="Jitwxs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/favicon.ico"><link rel="canonical" href="https://jitwxs.cn/page/16/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?053091e29f160d71ed2f65a774cfeac1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-40VH67TNSM"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-40VH67TNSM');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"POGNXMLA2T","apiKey":"2013ebed0f76818838d693c9c40cb1fd","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jitwxs","link":"链接: ","source":"来源: Jitwxs","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Jitwxs',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-09-25 12:21:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Jitwxs" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">229</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">133</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fas fa-ellipsis-v"></i><span> 更多</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/favorites/"><i class="fa-fw fas fa-meteor"></i><span> 收藏夹</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-cogs"></i><span> 管理</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-location-arrow"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/statistical/"><i class="fa-fw fas fa-globe-asia"></i><span> 站点统计</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jitwxs</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fas fa-ellipsis-v"></i><span> 更多</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/favorites/"><i class="fa-fw fas fa-meteor"></i><span> 收藏夹</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-cogs"></i><span> 管理</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-location-arrow"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/statistical/"><i class="fa-fw fas fa-globe-asia"></i><span> 站点统计</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/71543ef6.html" title="SpringBoot 集成 Spring Security（5）——权限控制">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot 集成 Spring Security（5）——权限控制"></a></div><div class="recent-post-info"><a class="article-title" href="/71543ef6.html" title="SpringBoot 集成 Spring Security（5）——权限控制">SpringBoot 集成 Spring Security（5）——权限控制</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-15T11:09:28.000Z" title="发表于 2018-05-15 19:09:28">2018-05-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/">安全框架</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/Spring-Security/">Spring Security</a></span></div><div class="content">在第一篇中，我们说过，用户&lt;–&gt;角色&lt;–&gt;权限三层中，暂时不考虑权限，在这一篇，是时候把它完成了。
为了方便演示，这里的权限只是对角色赋予权限，也就是说同一个角色的用户，权限是一样的。当然了，你也可以精细化到为每一个用户设置权限，但是这不在本篇的探讨范围，有兴趣可以自己实验，原理都是一样的。
 一、数据准备
 1.1 创建 sys_permission 表
让我们先创建一张权限表，名为 sys_permission：
123456789CREATE TABLE `sys_permission` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `url` varchar(255) DEFAULT NULL,  `role_id` int(11) DEFAULT NULL,  `permission` varchar(255) DEFAULT NULL,  PRIMARY KEY (`id`),  KEY `fk_roleId` (`role_id`),  CONSTRAINT `fk_roleId` FOREIGN KEY (` ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/cd6f6a52.html" title="Nginx 缓存使用官方指南">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx 缓存使用官方指南"></a></div><div class="recent-post-info"><a class="article-title" href="/cd6f6a52.html" title="Nginx 缓存使用官方指南">Nginx 缓存使用官方指南</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">张帆</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-11T06:11:17.000Z" title="发表于 2018-05-11 14:11:17">2018-05-11</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/Nginx/">Nginx</a></span></div><div class="content">我们都知道，应用程序和网站一样，其性能关乎生存。但如何使你的应用程序或者网站性能更好，并没有一个明确的答案。代码质量和架构是其中的一个原因，但是在很多例子中我们看到，你可以通过关注一些十分基础的应用内容分发技术，来提高终端用户的体验。其中一个例子就是实现和调整应用栈（application stack）的缓存。这篇文章，通过几个例子来讲述如何使用Nginx缓存。此外，结尾处还列举了一些常见问题及解答。
 基础
一个 web 缓存坐落于客户端和“原始服务器（origin server）”中间，它保留了所有可见内容的拷贝。如果一个客户端请求的内容在缓存中存储，则可以直接在缓存中获得该内容而不需要与服务器通信。这样一来，由于 web 缓存距离客户端“更近”，就可以提高响应性能，并更有效率的使用应用服务器，因为服务器不用每次请求都进行页面生成工作。
在浏览器和应用服务器之间，存在多种“潜在”缓存，如：客户端浏览器缓存、中间缓存、内容分发网络（CDN）和服务器上的负载平衡和反向代理。缓存，仅在反向代理和负载均衡的层面，就对性能提高有很大的帮助。
举个例子说明，去年，我接手了一项任务，这项任务的内 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/f420faae.html" title="SpringBoot 集成 Spring Security（4）——自定义表单登录">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot 集成 Spring Security（4）——自定义表单登录"></a></div><div class="recent-post-info"><a class="article-title" href="/f420faae.html" title="SpringBoot 集成 Spring Security（4）——自定义表单登录">SpringBoot 集成 Spring Security（4）——自定义表单登录</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-09T07:05:40.000Z" title="发表于 2018-05-09 15:05:40">2018-05-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/">安全框架</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/Spring-Security/">Spring Security</a></span></div><div class="content">通过前面三篇文章，你应该大致了解了 Spring Security 的流程。你应该发现了，真正的 login 请求是由 Spring Security 帮我们处理的，那么我们如何实现自定义表单登录呢，比如添加一个验证码…
 一、添加验证码
 1.1 验证码 Servlet
验证码的 Servlet 代码，大家无需关心其内部实现，我也是百度直接捞了一个，直接复制即可。
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/eb7552c8.html" title="SpringBoot 集成 Spring Security（3）——异常处理">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot 集成 Spring Security（3）——异常处理"></a></div><div class="recent-post-info"><a class="article-title" href="/eb7552c8.html" title="SpringBoot 集成 Spring Security（3）——异常处理">SpringBoot 集成 Spring Security（3）——异常处理</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-09T02:48:06.000Z" title="发表于 2018-05-09 10:48:06">2018-05-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/">安全框架</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/Spring-Security/">Spring Security</a></span></div><div class="content">不知道你有没有注意到，当我们登陆失败时候，Spring security 帮我们跳转到了 /login?error Url，奇怪的是不管是控制台还是网页上都没有打印错误信息。

这是因为首先 /login?error 是 Spring security 默认的失败 Url，其次如果你不手动处理这个异常，这个异常是不会被处理的。
 一、常见异常
我们先来列举下一些 Spring Security 中常见的异常：

UsernameNotFoundException（用户不存在）
DisabledException（用户已被禁用）
BadCredentialsException（坏的凭据）
LockedException（账户锁定）
AccountExpiredException （账户过期）
CredentialsExpiredException（证书过期）
…

以上列出的这些异常都是 AuthenticationException 的子类，然后我们来看看 Spring security 如何处理 AuthenticationException 异常的。
 二、源码分析
我们知道异常处 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/8e248ac0.html" title="SpringBoot 集成 Spring Security（2）——自动登录">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover7.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot 集成 Spring Security（2）——自动登录"></a></div><div class="recent-post-info"><a class="article-title" href="/8e248ac0.html" title="SpringBoot 集成 Spring Security（2）——自动登录">SpringBoot 集成 Spring Security（2）——自动登录</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-09T02:22:57.000Z" title="发表于 2018-05-09 10:22:57">2018-05-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/">安全框架</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/Spring-Security/">Spring Security</a></span></div><div class="content">在上一章：《SpringBoot集成Spring Security（1）——入门程序》中，我们实现了入门程序，本篇为该程序加上自动登录的功能。
 一、修改 login.html
在登陆页添加自动登录的选项，注意自动登录字段的 name 属性必须是 remember-me ：
login.html12345678910111213141516171819202122&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;登陆&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;登陆&lt;/h1&gt;&lt;form method=&quot;post&quot; action=&quot;/login&quot;&gt;    &lt;div&gt;        用户名：&lt;input type=&quot;text&quot; name=&qu ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/5f5715e6.html" title="SpringBoot 集成 Spring Security（1）——入门程序">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot 集成 Spring Security（1）——入门程序"></a></div><div class="recent-post-info"><a class="article-title" href="/5f5715e6.html" title="SpringBoot 集成 Spring Security（1）——入门程序">SpringBoot 集成 Spring Security（1）——入门程序</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-09T01:47:49.000Z" title="发表于 2018-05-09 09:47:49">2018-05-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/">安全框架</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/Spring-Security/">Spring Security</a></span></div><div class="content">因为项目需要，第一次接触 Spring Security，早就听闻 Spring Security 功能强大但上手困难，学习了几天出入门道，特整理这篇文章希望能让后来者少踩一点坑（本文附带实例程序，请放心食用）
本系列文章环境：SpringBoot 2.0 + Mybatis，SpringSecurity 5.0+ 版本变动较多，且不兼容之前版本，确保你的 SpringBoot 版本为 2.0，能帮你避免掉大部分的坑。

 一、导入依赖
导入 spring-boot-starter-security 依赖，在 SpringBoot 2.0 环境下默认使用的是 5.0 版本。
1234567891011121314151617181920212223242526&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;de ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/a979ce.html" title="ActiveMQ 初探（3）——与 SpringBoot 整合">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover10.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ActiveMQ 初探（3）——与 SpringBoot 整合"></a></div><div class="recent-post-info"><a class="article-title" href="/a979ce.html" title="ActiveMQ 初探（3）——与 SpringBoot 整合">ActiveMQ 初探（3）——与 SpringBoot 整合</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-08T15:49:01.000Z" title="发表于 2018-05-08 23:49:01">2018-05-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a></span></div><div class="content"> 一、发送即时消息
 1.1 添加依赖包
这里我们不使用网上大多数的 spring-boot-starter-activemq，因为我配的时候总是有问题，我改为使用如下的三个依赖包，分别是 activemq连接池包、activemq包 和 jms包：
12345678910111213141516&lt;!-- ActiveMQ连接池 --&gt;&lt;dependency&gt;    &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;    &lt;artifactId&gt;activemq-pool&lt;/artifactId&gt;    &lt;version&gt;5.15.3&lt;/version&gt;&lt;/dependency&gt;&lt;!-- ActiveMQ --&gt;&lt;dependency&gt;    &lt;groupId&gt;org.springframework&lt;/groupId&gt;    &lt;artifactId&gt;spring-jms&lt;/artifac ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/5f77c427.html" title="ActiveMQ 初探（2）——与 Spring 整合">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover16.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ActiveMQ 初探（2）——与 Spring 整合"></a></div><div class="recent-post-info"><a class="article-title" href="/5f77c427.html" title="ActiveMQ 初探（2）——与 Spring 整合">ActiveMQ 初探（2）——与 Spring 整合</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-08T14:50:53.000Z" title="发表于 2018-05-08 22:50:53">2018-05-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a></span></div><div class="content"> 一、环境准备
与 Spring 整合，除了原本的 activemq-all 外，还需导入 spring-context-support 和 spring-jms 包，如果 Spring 为5.0+，需要 javax.jms-api 依赖：
123456789101112131415161718192021&lt;dependency&gt;    &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;    &lt;artifactId&gt;activemq-all&lt;/artifactId&gt;    &lt;version&gt;5.15.3&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.springframework&lt;/groupId&gt;    &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;    &lt;version&gt;5.0.4.R ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/4be9221b.html" title="Navicat Premium 12.0.27 安装与激活">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Navicat Premium 12.0.27 安装与激活"></a></div><div class="recent-post-info"><a class="article-title" href="/4be9221b.html" title="Navicat Premium 12.0.27 安装与激活">Navicat Premium 12.0.27 安装与激活</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-04T07:50:59.000Z" title="发表于 2018-05-04 15:50:59">2018-05-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></span></div><div class="content">首先下载 Navicat Premium 12.0.27 安装包和破解工具：
Download For CSDN
Download For BaiduPan[14qh]
以下是重点，请务必仔细阅读！！
Step0：
运行安装包：navicat12027_premium_cs_x64.exe，常规安装即可。
Step1：
安装完成后，打开注册机：Navicat_Keygen_Patch_v3.4_By_DFoX_URET.exe：
1)Patch勾选Backup、Host和Navicat v12，然后点击Patch按钮：

找到Navicat Premium 12安装路径下的navicat.exe，选中并点击打开：

然后弹出Info对话框：

Step2：


License, Product and Language 确保 License 为Enterprise，Products 为Premium，Languages 为Simplified Chinese（简体中文，其它语言版本请自选）；


Resale License 确保 Resale Version 为Site licens ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/7ac4f061.html" title="Json Web Token 介绍与基本使用">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover6.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Json Web Token 介绍与基本使用"></a></div><div class="recent-post-info"><a class="article-title" href="/7ac4f061.html" title="Json Web Token 介绍与基本使用">Json Web Token 介绍与基本使用</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-user article-meta__icon"></i><span class="article-meta-label">Jitwxs</span><span class="article-meta__separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2018-05-02T18:25:18.000Z" title="发表于 2018-05-03 02:25:18">2018-05-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java-Web/">Java Web</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Java-Web/SpringBoot/">SpringBoot</a></span></div><div class="content"> 一、Session 与 JWT
 1.1 传统 Cookie + Session
Cookie+Session 的存在主要是为了解决HTTP这一无状态协议下服务器如何识别用户的问题。
其原理就是在用户登录通过验证后，服务端将数据加密后存储在服务器 Session 中，同时服务器将 Session 的标识即 SessionId 存放在客户端 Cookie 中。
用户之后发起的请求都会携带 Cookie 信息，服务器根据 SessionId 寻回对应的 Session，从而完成验证，确认这是之前登陆过的用户。其工作原理如下图所示：

 1.2 JWT 技术
JWT，即 JSON Web Token，当用户使用它的认证信息登陆系统之后，会返回给用户一个 JWT，用户只需要本地保存即可。
当用户希望访问一个受保护的路由或者资源的时候，在请求头部添加该 JWT。后台获取请求头部的JWT并进行验证，如果合法，则允许用户的行为。

 二、JWT 的组成
一个 JWT 实际上就是一个字符串，它由三部分组成：头部、载荷(Payload)与签名。
 2.1 头部
头部用于描述关于该JWT的最基本的信息， ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/15/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/#content-inner">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/#content-inner">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/#content-inner">23</a><a class="extend next" rel="next" href="/page/17/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/configuration/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jitwxs</div><div class="author-info__description">不忘初心，砥砺前行</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">229</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">133</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jitwxs"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/jitwxs" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=Ujg7JiUqIRI0PSo-Mzs_fDE9Pw" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="https://jitwxs.blog.csdn.net" target="_blank" title="CSDN"><i class="fab fa-cuttlefish flat-btn"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">专注 Java 后端开发，内容涵盖 SpringBoot、并发编程、微服务、容器化、Linux 等技术分享。</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/208fa04c.html" title="Mockito 源码分析（4）——Annotation"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mockito 源码分析（4）——Annotation"/></a><div class="content"><a class="title" href="/208fa04c.html" title="Mockito 源码分析（4）——Annotation">Mockito 源码分析（4）——Annotation</a><time datetime="2021-09-21T13:52:51.000Z" title="发表于 2021-09-21 21:52:51">2021-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/921b3e8a.html" title="Mockito 源码分析（3）——When 与 Then 与 Verify"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover19.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mockito 源码分析（3）——When 与 Then 与 Verify"/></a><div class="content"><a class="title" href="/921b3e8a.html" title="Mockito 源码分析（3）——When 与 Then 与 Verify">Mockito 源码分析（3）——When 与 Then 与 Verify</a><time datetime="2021-09-20T12:32:05.000Z" title="发表于 2021-09-20 20:32:05">2021-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/cb1af043.html" title="Mockito 源码分析（2）——Mock 与 Spy"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover6.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mockito 源码分析（2）——Mock 与 Spy"/></a><div class="content"><a class="title" href="/cb1af043.html" title="Mockito 源码分析（2）——Mock 与 Spy">Mockito 源码分析（2）——Mock 与 Spy</a><time datetime="2021-09-20T01:48:47.000Z" title="发表于 2021-09-20 09:48:47">2021-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/f9625997.html" title="Mockito 源码分析（1）——基础概念"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover15.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mockito 源码分析（1）——基础概念"/></a><div class="content"><a class="title" href="/f9625997.html" title="Mockito 源码分析（1）——基础概念">Mockito 源码分析（1）——基础概念</a><time datetime="2021-09-20T01:02:35.000Z" title="发表于 2021-09-20 09:02:35">2021-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/e5e60178.html" title="Protobuf 与 JSON 的互相转换"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jitwxs/cdn/blog/top/cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Protobuf 与 JSON 的互相转换"/></a><div class="content"><a class="title" href="/e5e60178.html" title="Protobuf 与 JSON 的互相转换">Protobuf 与 JSON 的互相转换</a><time datetime="2021-08-29T11:42:45.000Z" title="发表于 2021-08-29 19:42:45">2021-08-29</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/HoloLens/"><span class="card-category-list-name">HoloLens</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">59</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Disruptor/"><span class="card-category-list-name">Disruptor</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Protobuf/"><span class="card-category-list-name">Protobuf</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">并发编程</span><span class="card-category-list-count">15</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/"><span class="card-category-list-name">性能分析</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">日志框架</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="card-category-list-name">设计模式</span><span class="card-category-list-count">3</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 1.2em; color: rgb(115, 144, 121)">总结</a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.15em; color: rgb(199, 81, 6)">面试</a><a href="/tags/ActiveMQ/" style="font-size: 1.25em; color: rgb(85, 9, 29)">ActiveMQ</a><a href="/tags/Ajax/" style="font-size: 1.15em; color: rgb(162, 62, 33)">Ajax</a><a href="/tags/Javascript/" style="font-size: 1.2em; color: rgb(1, 92, 89)">Javascript</a><a href="/tags/Arthas/" style="font-size: 1.4em; color: rgb(109, 114, 200)">Arthas</a><a href="/tags/%E7%81%AB%E7%84%B0%E5%9B%BE/" style="font-size: 1.15em; color: rgb(126, 130, 1)">火焰图</a><a href="/tags/%E8%B7%A8%E5%9F%9F/" style="font-size: 1.15em; color: rgb(11, 178, 146)">跨域</a><a href="/tags/Vue/" style="font-size: 1.15em; color: rgb(117, 17, 169)">Vue</a><a href="/tags/Axiso/" style="font-size: 1.15em; color: rgb(134, 103, 156)">Axiso</a><a href="/tags/Disruptor/" style="font-size: 1.3em; color: rgb(110, 109, 163)">Disruptor</a><a href="/tags/Dubbo/" style="font-size: 1.15em; color: rgb(48, 163, 162)">Dubbo</a><a href="/tags/Zookeeper/" style="font-size: 1.2em; color: rgb(116, 29, 107)">Zookeeper</a><a href="/tags/Eclipse/" style="font-size: 1.15em; color: rgb(155, 129, 185)">Eclipse</a><a href="/tags/Elasticsearch/" style="font-size: 1.35em; color: rgb(100, 53, 65)">Elasticsearch</a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.15em; color: rgb(185, 112, 8)">索引</a><a href="/tags/Freemarker/" style="font-size: 1.15em; color: rgb(178, 194, 139)">Freemarker</a><a href="/tags/GCC/" style="font-size: 1.15em; color: rgb(165, 14, 59)">GCC</a><a href="/tags/Git/" style="font-size: 1.45em; color: rgb(163, 156, 105)">Git</a><a href="/tags/SpringBoot/" style="font-size: 1.45em; color: rgb(181, 184, 34)">SpringBoot</a><a href="/tags/UML/" style="font-size: 1.15em; color: rgb(186, 167, 187)">UML</a><a href="/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" style="font-size: 1.15em; color: rgb(16, 45, 197)">动态代理</a><a href="/tags/AOP/" style="font-size: 1.2em; color: rgb(116, 18, 31)">AOP</a><a href="/tags/Fail-Fast/" style="font-size: 1.15em; color: rgb(82, 117, 55)">Fail Fast</a><a href="/tags/Fail-Safe/" style="font-size: 1.15em; color: rgb(12, 93, 183)">Fail Safe</a><a href="/tags/%E8%B8%A9%E5%9D%91%E4%B9%8B%E8%B7%AF/" style="font-size: 1.2em; color: rgb(65, 63, 65)">踩坑之路</a><a href="/tags/%E4%B8%89%E6%96%B9%E6%94%AF%E4%BB%98/" style="font-size: 1.15em; color: rgb(149, 91, 172)">三方支付</a><a href="/tags/%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE/" style="font-size: 1.15em; color: rgb(140, 194, 183)">双亲委派</a><a href="/tags/%E9%98%9F%E5%88%97/" style="font-size: 1.25em; color: rgb(93, 25, 152)">队列</a><a href="/tags/ArrayBlockingQueue/" style="font-size: 1.15em; color: rgb(134, 101, 168)">ArrayBlockingQueue</a><a href="/tags/CyclicBarrier/" style="font-size: 1.15em; color: rgb(54, 182, 64)">CyclicBarrier</a><a href="/tags/Thread/" style="font-size: 1.15em; color: rgb(71, 17, 123)">Thread</a><a href="/tags/XML/" style="font-size: 1.15em; color: rgb(169, 46, 22)">XML</a><a href="/tags/Optional/" style="font-size: 1.15em; color: rgb(200, 63, 29)">Optional</a><a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 1.15em; color: rgb(103, 52, 103)">文件系统</a><a href="/tags/Linux/" style="font-size: 1.15em; color: rgb(191, 148, 77)">Linux</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.15em; color: rgb(148, 60, 137)">数据库</a><a href="/tags/Tomcat/" style="font-size: 1.15em; color: rgb(57, 108, 102)">Tomcat</a><a href="/tags/%E9%9D%99%E6%80%81%E5%BA%93/" style="font-size: 1.15em; color: rgb(52, 75, 170)">静态库</a><a href="/tags/%E5%8A%A8%E6%80%81%E5%BA%93/" style="font-size: 1.15em; color: rgb(4, 18, 176)">动态库</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">229</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2016-11-12T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">567.6k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-09-25T04:21:51.769Z"></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(135deg,"><div id="footer-wrap"><div class="copyright">&copy;2016 - 2021 By Jitwxs</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href='http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action'><img class='icp-icon entered loading' src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='/img/icp.png' alt='ICP' data-ll-status='loading'>苏 ICP 备 16061429 号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/jitwxs/blog-comment/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="5273081683" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" data-lrctype="1" muted></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-40VH67TNSM', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?jitwxs";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="jitwxs";
            var parent_div_git = document.getElementById('about-github-calendar');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('about-github-calendar')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 80px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><!-- hexo injector body_end end --></body></html>